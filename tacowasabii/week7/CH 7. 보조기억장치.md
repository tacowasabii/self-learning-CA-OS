# CH 7. 보조기억장치

## 7-1 다양한 보조기억장치

### 하드 디스크

**하드 디스크**는 자기적인 방식으로 데이터를 저장하는 보조기억장치이다. 이 때문에 하드 디스크를 **자기 디스크**의 일종으로 지칭하기도 한다.

하드 디스크에서 데이터가 저장되는 곳은 동그란 원판으로 **플래터**라고 한다. 플래터는 자기 물질로 덮여 있어 수많은 N극과 S극을 저장한다. N극과 S극은 0과 1의 역할을 수행한다. 플래터를 회정시키는 구성 요소를 **스핀들**이라고 한다. 스핀들이 플래터를 돌리는 속도는 분당 회전수를 나타내는 **RPM**이라는 단위로 표현된다.

플래터를 대상으로 데이터를 읽고 쓰는 구성 요소는 **헤드**이다. 헤드는 플래터 위에엇 미세하게 떠 있는 채로 데이터를 읽고 쓰는, 마치 바늘같이 생긴 부품이다. 그리고 헤드는 원하는 위치로 헤드를 이동시키는 **디스크 암**에 부착되어 있다.

하드 디스크는 많은 양의 데이터를 저장해야 하므로 일반적으로 여러 겹의 플래터로 이루어져 있고 플래터 양면을 모두 사용할 수 있다. 양면 플래터를 사용하면 위아래로 플래터당 두 개의 헤드가 사용된다.

플래터는 **트랙**과 **섹터**라는 단위로 데이터를 저장한다. 플래터를 여러 동심원으로 나누었을 때 그중 하나의 원을 트랙이라고 부른다. 그리고 트랙은 피자처럼 여러 조각으로 나누어지는데, 이 한 조각을 섹터라고 부른다. 섹터는 하드 디스크의 가장 작은 전송 단위이다.

여러 겹의 플래터 상에서 같은 트랙이 위치한 곳을 모아 연결한 논리적 단위를 **실린더**라고 부른다. 쉽게 말해 한 플래터를 동심원으로 나눈 공간은 트랙, 같은 트랙끼리 연결한 원통 모양의 공간은 실린더이다. 연속된 정보는 보통 한 실린더에 기록된다. 그 이유는 디스크 암을 움직이지 않고도 바로 데이터에 접근할 수 있기 때문이다.

하드 디스크가 저장된 데이터에 접근하는 시간은 크게 **탐색 시간, 회전 지연, 전송 시간**으로 나뉜다. **탐색 시간**은 접근하려는 데이터가 저장된 트랙까지 헤드를 이동시키는 시간을 의미한다. **회전 지연**은 헤드가 있는 곳으로 플래터를 회전시키는 시간을 의미한다. **전송 시간**은 하드 디스크와 컴퓨터 간에 데이터를 전송하는 시간을 의미한다.

탐색 시간과 회전 지연을 단축시키기 위해서는 RPM을 높이는 것도 중요하지만 참조 지역성, 즉 접근하려는 데이터가 플래터 혹은 헤드를 조금만 옮겨도 접근할 수 있는 곳에 위치해 있는 것도 중요한다.

#### 다중 헤드 디스크와 고정 헤드 디스크

플래터의 한 면당 헤드가 하나씩 달려 있는 하드 디스크를 **단일 헤드 디스크**라고 부른다. 반면 헤드가 트랙별로 여러 개 달려 있는 하드 디스크를 **다중 헤드 디스크**라고 부른다. 다중 헤드 디스크는 탐색 시간이 0이다.

이런 점에서 헤드를 움직일 필요가 없는 다중 헤드 디스크를 **고정 헤드 디스크**라고도 부른다. 반대로 헤드를 데이터가 있는 곳까지 움직여야 하는 단일 헤드 디스크를 **이동 헤드 디스크**라고 부른다.

### 플래시 메모리

**플래시 메모리**는 전기적으로 데이터를 읽고 쓸 수 있는 반도체 기반의 저장 장치이다. 플래시 메모리는 보조기억장치 범주에만 속한다기보다는 다양한 곳에서 널리 사용하는 저장 장치로 보는 것이 옳다. ROM에도 사용되고, 거의 모든 전자 제품 안에 플래시 메모리가 내장되어 있다.

플래시 메모리에는 **셀**이라는 단위가 있다. 셀이란 플래시 메모리에서 데이터를 저장하는 가장 작은 단위이다. 이 셀이 모이고 모여 MB, GB, TB 용량을 갖는 저장 장치가 되는 것이다. 하나의 셀에 몇 비트를 저장할 수 있느냐에 ㄸ라 플래시 메모리 종류가 나뉜다. 한 셀에 1비트를 저장할 수 있는 플래시 메모리를 **SLC 타입**, 2비트를 저장할 수 있는 플래시 메모리를 **MLC 타입**, 3비트를 저장할 수 있는 플래시 메모리를 **TLC 타입**이라고 한다.

#### SLC 타입

SLC 타입은 한 셀로 두 개의 정보를 표현할 수 있다. MLC나 TLC 타입에 비해 비트의 빠른 입출력이 가능하다. 수명도 길어서 수만에서 수십만 번 가까이 데이터를 쓰고 지울 수 있다. 하지만 용량 대비 가격이 높다. 그렇기에 보통 기업에서 데이터를 읽고 쓰기가 매우 많이 반복되며 고성능의 빠른 저장 장치가 필요한 경우에 SLC 타입을 사용한다.

#### MLC 타입

MLC 타입은 한 셀로 네 개의 정보를 표현할 수 있다. SLC 타입보다 속도와 수명은 떨어지지만 대용량화하기 유리하다. 용량 대비 가격도 저렴하다. 시중에서 사용되는 많은 플래시 메모리 저장 장치들이 MLC 타입으로 만들어진다.

#### TLC 타입

TLC 타입은 한 셀로 여덟 개의 정보를 표현할 수 있다. SLC, MLC 타입보다 속도와 수명은 떨어지지만 대용량화하기 유리하다. 용량 대비 가격도 더 저렴하다.

셀들이 모여 만들어진 단위를 **페이지**, 그리고 페이지가 모여 만들어진 단위를 **블록**이라고 한다. 블록이 모여 **플레인**, 플레인이 모여 **다이**가 된다.

플래시 메모리에서 읽기와 쓰기는 페이지 단위로 이루어진다. 하지만 삭제는 페이지보다 큰 블록 단위로 이루어진다. 읽기/쓰기 단위와 삭제 단위가 다르다는 것이 플래시 메모리의 가장 큰 특징 중 하나이다.

이때 페이지는 세 개의 상태를 가질 수 있다. 이는 각각 **Free, Valid, Invalid** 상태이다. **Free 상태**는 어떠한 데이터도 저장하고 있지 않아 새로운 데이터를 저장할 수 있는 상태를 의미한다. **Valid 상태**는 이미 유효한 데이터를 저장하고 있는 상태를 의미한다. 그리고 **Invalid 상태**는 쓰레기값이라 부르는 유효하지 않은 데이터를 저장하고 있는 상태를 의미한다. 플래시 메모리는 하드 디스크와는 달리 덮어쓰기가 불가능하여 Valid 상태인 페이지에는 새 데이터를 저장할 수 없다.

쓰레기값을 저장하고 있는 공간이 생겼을 때 이를 정리하기 위한 **가비지 컬렉션** 기능이 있다. 가비지 컬렉션은 유효한 페이지들만을 새로운 블록으로 복사한 뒤, 기존의 블록을 삭제하는 기능이다.

## 7-2 RAID의 정의와 종류

### RAID의 정의

**RAID**(Redundant Array of Independent Disks)는 주로 하드 디스크와 SSD를 사용하는 기술로, 데이터의 안정성 혹은 높은 성능을 위해 여러 개의 물리적 보조기억장치를 마치 하나의 논리적 보조기억장치처럼 사용하는 기술을 의미한다.

### RAID의 종류

RAID의 구성 방법을 **RAID 레벨**이라 표현하는데, RAID 레벨에는 대표적으로 RAID 0, RAID 1, RAID 2, RAID 3, RAID 4, RAID 5, RAID 6이 있고, 그로부터 파생된 RAID 10, RAID 50 등이 있다. RAID 2와 RAID 3은 현재 잘 활용되지 않는다.

#### RAID 0

**RAID 0**은 여러 개의 보조기억장치에 데이터를 단순히 나누어 저장하는 구성 방식이다. 어떤 데이터를 저장할 때 각 하드 디스크가 번갈아 가며 데이터를 저장한다. 즉, 저장되는 데이터가 하드 디스크 개수만큼 나뉘어 저장된다. 이때 마치 줄무늬처럼 분산되어 저장된 데이터를 **스트라입**이라 하고, 분산하여 저장하는 것을 **스트라이핑**이라고 한다.

스트라이핑되면 저장된 데이터를 읽고 쓰는 속도가 빨라진다. 하나의 대용량 저장 장치를 이용했더라면 여러 번에 걸쳐 읽고 썼을 데이터를 동시에 읽고 쓸 수 있기 때문이다. 그렇기에 4TB 저장 장치 한 개를 읽고 쓰는 속도보다 RAID 0으로 구성된 1TB 저장 장치 네 개의 속도가 이론상 네 배가량 빠르다.

하지만 RAID 0은 저장된 정보가 안전하지 않다. RAID 0으로 구성된 하드 디스크 중 하나에 문제가 생긴다면 다른 모든 하드 디스크의 정보를 읽는 데 문제가 생길 수 있다. 그래서 등장한 것이 RAID 1이다.

![alt text](<KakaoTalk_Photo_2024-09-20-13-32-26 001.jpeg>)

#### RAID 1

**RAID 1**은 복사본을 만드는 방식이다. 마치 거울처럼 완전한 복사본을 만드는 구성이기에 **미러링**이라고도 부른다. RAID 1에 어떠한 데이터를 쓸 때는 원본과 복사본 두 군데에 쓴다. 그렇기에 쓰기 속도는 RAID 0보다 느리다.

RAID 1 방식은 복구가 매우 간단하다는 장점이 있다. 똑같은 디스크가 두 개 있는 셈이니, 하나에 문제가 발생해도 잃어버린 정보를 금방 되찾을 수 있다.

하지만 RAID 1은 하드 디스크 개수가 한정되었을 때 사용 가능한 용량이 적어지는 단점이 있다. RAID 1에서는 복사본이 만들어지는 용량만큼 사용자가 사용하지 못한다. 결국 많은 양의 하드 디스크가 필요하게 되고, 비용이 증가한다는 단점으로도 이어진다.

![alt text](<KakaoTalk_Photo_2024-09-20-13-32-26 002.jpeg>)

#### RAID 4

**RAID 4**는 RAID 1처럼 완전한 복사본을 만드는 대신 **오류를 검출하고 복구하기 위한 정보를 저장한 장치**를 두는 구성 방식이다. 이때 '오류를 검출하고 복구하기 위한 정보'를 **패리티 비트**라고 한다. RAID 4에서는 패리티를 저장한 장치를 이용해 다른 장치들의 오류를 검출하고, 오류가 있다면 복구한다. 이로써 RAID 4는 RAID 1보다 적은 하드 디스크로도 데이터를 안전하게 보관할 수 있다.

![alt text](<KakaoTalk_Photo_2024-09-20-13-32-26 003.jpeg>)

> 원래 패리티 비트는 오류 검출만 가능할 뿐 오류 복구는 불가능하다. 하지만 RAID에서는 패리티 값으로 오류 수정도 가능하다.

#### RAID 5

RAID 4에서는 어떤 새로운 데이터가 저장될 때마다 패리티를 저장하는 디스크에도 데이터를 쓰게되므로 패리티를 저장하는 장치에 병목 현상이 발생한다는 문제가 있다. **RAID 5**는 패리티 정보를 분산하여 저장하는 방식으로 병목 현상을 해소한다.

![alt text](<KakaoTalk_Photo_2024-09-20-13-32-26 004.jpeg>)

#### RAID 6

**RAID 6**의 구성은 기본적으로 RAID 5와 같으나, 아래와 같이 서로 다른 두 개의 패리티를 구성하는 방식이다. 이는 오류를 검출하고 복구할 수 있는 수단이 두 개가 생긴 셈이다. 따라서 RAID 6은 RAID 4나 5보다 안전한 구성이라고 볼 수 있다. 다만 새로운 정보를 저장할 때마다 함께 저장할 패리티가 두 개이므로, 쓰기 속도는 RAID 5보다 느리다. 따라서 RAID 6은 데이터 저장 속도를 조금 희생하더라도 데이터를 더욱 안전하게 보관하고 싶을 때 사용하는 방식이다.
![alt text](<KakaoTalk_Photo_2024-09-20-13-32-27 005.jpeg>)

RAID 10은 RAID 0과 RAID 1을 혼합한 방식이고, RAID 50은 RAID 0과 RAID 5를 혼합한 방식이다. 이렇게 여러 RAID 레벨을 혼합한 방식을 **Nested RAID**라고 한다.
